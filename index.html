<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Transportation Digital Sign Board - Dashboard</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
  <style>
    :root{
      --bg1: #fff4f8;
      --bg2: #ffeef6;
      --card: rgba(255,255,255,0.8);
      --accent: #ff6fb5;
      --muted: #7a6b78;
      --glass: rgba(255,255,255,0.6);
    }
    *{box-sizing:border-box;font-family:Inter,system-ui,Segoe UI,Roboto,'Helvetica Neue',Arial}
    html,body{height:100%;margin:0;background:linear-gradient(135deg,var(--bg1),var(--bg2));color:#332435}
    .wrap{max-width:1200px;margin:28px auto;padding:20px}
    header{display:flex;align-items:center;justify-content:space-between;margin-bottom:18px}
    header h1{font-size:1.5rem;margin:0}
    header p{margin:0;color:var(--muted)}

    .board{display:grid;grid-template-columns:1fr 420px;gap:18px}

    /* left: lanes */
    .lanes{display:flex;flex-direction:column;gap:12px}
    .lane-card{background:var(--card);backdrop-filter:blur(6px);padding:14px;border-radius:12px;display:flex;align-items:center;justify-content:space-between;box-shadow:0 6px 20px rgba(184,128,160,0.08);position:relative;overflow:hidden}
    .lane-info{display:flex;align-items:center;gap:12px}
    .lane-pill{width:54px;height:54px;border-radius:10px;display:flex;align-items:center;justify-content:center;font-weight:700;color:white}
    .l1{background:linear-gradient(180deg,#ffd1e8,#ffb3db)}
    .l2{background:linear-gradient(180deg,#fff0c2,#ffd77a);color:#6b4b00}
    .l3{background:linear-gradient(180deg,#d6fff0,#9ef0d0)}
    .lane-meta{min-width:220px}
    .lane-title{font-size:1.05rem;margin:0}
    .lane-sub{color:var(--muted);font-size:0.9rem;margin-top:4px}

    /* rollover / action buttons */
    .actions{display:flex;gap:8px}
    .btn{background:transparent;border:1px solid rgba(51,36,53,0.08);padding:8px 10px;border-radius:8px;cursor:pointer;display:inline-flex;align-items:center;gap:8px}
    .btn:hover{transform:translateY(-3px)}
    .btn.important{border-color:rgba(255,111,181,0.95);box-shadow:0 6px 18px rgba(255,111,181,0.12)}

    /* right: charts and details */
    .panel{background:var(--glass);padding:14px;border-radius:12px;backdrop-filter:blur(6px);min-height:320px}
    .charts{display:flex;flex-direction:column;gap:12px}
    .chart-wrap{padding:8px;background:linear-gradient(180deg,rgba(255,255,255,0.7),rgba(255,255,255,0.55));border-radius:10px}

    footer{margin-top:14px;color:var(--muted);font-size:0.9rem}

    /* small screen */
    @media (max-width:880px){
      .board{grid-template-columns:1fr;}
      .panel{order:-1}
    }

    /* marquee-style digital sign at top */
    .digital-sign{width:100%;padding:10px;border-radius:10px;background:linear-gradient(90deg,#ffe7f3, #fff5e8);border:1px solid rgba(0,0,0,0.02);display:flex;align-items:center;gap:16px}
    .sign-text{font-weight:700;letter-spacing:0.3px}
    .marquee{overflow:hidden;white-space:nowrap}
    .marquee span{display:inline-block;padding-left:100%;animation:mar 14s linear infinite}
    @keyframes mar{from{transform:translateX(0%)}to{transform:translateX(-100%)}}

    /* hover detail tooltip */
    .tooltip{position:absolute;right:12px;top:12px;background:white;padding:8px;border-radius:8px;box-shadow:0 8px 24px rgba(0,0,0,0.08);display:none;font-size:0.9rem}
    .lane-card:hover .tooltip{display:block}

  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <div>
        <h1>Digital Sign Board — Lane Management</h1>
        <p>Three lanes separated: Lane 1 — Two Wheelers | Lane 2 — Emergency | Lane 3 — Four Wheelers</p>
      </div>
      <div id="timeNow"></div>
    </header>

    <div class="digital-sign">
      <div class="sign-text">LIVE STATUS</div>
      <div class="marquee"><span id="marqueeText">All systems normal • Lane-2 reserved for emergency vehicles • Use indicators • Drive safe</span></div>
    </div>

    <section class="board">
      <div class="lanes">
        <!-- LANE 1 -->
        <article class="lane-card" data-lane="1">
          <div class="lane-info">
            <div class="lane-pill l1">L1</div>
            <div class="lane-meta">
              <div class="lane-title">Lane - 1 <small style="font-weight:400">(Two Wheelers)</small></div>
              <div class="lane-sub" id="l1-sub">Status: Normal • Speed limit: 40 km/h</div>
            </div>
          </div>
          <div class="actions">
            <button class="btn" data-action="details" data-lane="1">Details</button>
            <button class="btn" data-action="highlight" data-lane="1">Highlight</button>
          </div>
          <div class="tooltip">Avg count/hr: <span id="t1">—</span></div>
        </article>

        <!-- LANE 2 -->
        <article class="lane-card" data-lane="2">
          <div class="lane-info">
            <div class="lane-pill l2">L2</div>
            <div class="lane-meta">
              <div class="lane-title">Lane - 2 <small style="font-weight:400">(Emergency Vehicles)</small></div>
              <div class="lane-sub" id="l2-sub">Status: Clear • Priority access</div>
            </div>
          </div>
          <div class="actions">
            <button class="btn" data-action="details" data-lane="2">Details</button>
            <button class="btn" data-action="highlight" data-lane="2">Highlight</button>
          </div>
          <div class="tooltip">Avg response/hr: <span id="t2">—</span></div>
        </article>

        <!-- LANE 3 -->
        <article class="lane-card" data-lane="3">
          <div class="lane-info">
            <div class="lane-pill l3">L3</div>
            <div class="lane-meta">
              <div class="lane-title">Lane - 3 <small style="font-weight:400">(Four Wheelers)</small></div>
              <div class="lane-sub" id="l3-sub">Status: Moderate • Keep distance</div>
            </div>
          </div>
          <div class="actions">
            <button class="btn" data-action="details" data-lane="3">Details</button>
            <button class="btn" data-action="highlight" data-lane="3">Highlight</button>
          </div>
          <div class="tooltip">Avg cars/hr: <span id="t3">—</span></div>
        </article>
      </div>

      <aside class="panel">
        <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:8px">
          <strong>Live Analytics</strong>
          <div style="display:flex;gap:8px;align-items:center">
            <label style="font-size:0.9rem;color:var(--muted)">Auto-refresh</label>
            <input type="checkbox" id="autorefresh" checked />
          </div>
        </div>

        <div class="charts">
          <div class="chart-wrap">
            <canvas id="barChart"></canvas>
          </div>

          <div class="chart-wrap">
            <canvas id="lineChart"></canvas>
          </div>

          <div style="display:flex;gap:8px;margin-top:8px;align-items:center;justify-content:space-between">
            <div style="font-size:0.95rem;color:var(--muted)">Click a lane's "Highlight" to pin it on charts; hover lane card for tooltip.</div>
            <div>
              <button class="btn" id="simulate">Simulate Traffic</button>
            </div>
          </div>
        </div>

      </aside>
    </section>

    <footer>Built for quick signage and monitoring. Customize lane names and speed limits in the script.</footer>
  </div>

  <script>
    // --- Simple single-file dashboard JS ---
    const nowEl = document.getElementById('timeNow');
    function updateTime(){
      const d = new Date();
      nowEl.textContent = d.toLocaleString();
    }
    setInterval(updateTime,1000); updateTime();

    // initial synthetic data (counts per hour)
    const lanes = {
      1: {label:'Two Wheelers', color:'#ff9dd7', counts:[22,18,24,20,26,30,28]},
      2: {label:'Emergency', color:'#ffd47a', counts:[2,1,0,1,0,2,1]},
      3: {label:'Four Wheelers', color:'#9ef0d0', counts:[14,12,16,18,22,25,21]}
    };

    // prepare charts
    const barCtx = document.getElementById('barChart').getContext('2d');
    const lineCtx = document.getElementById('lineChart').getContext('2d');

    const lastLabels = ['06:00','08:00','10:00','12:00','14:00','16:00','18:00'];

    function buildBarData(){
      return {
        labels:['Lane 1','Lane 2','Lane 3'],
        datasets:[{
          label:'Current hour count',
          data:[getLatest(1),getLatest(2),getLatest(3)],
          backgroundColor:[lanes[1].color,lanes[2].color,lanes[3].color],
          borderRadius:6
        }]
      }
    }

    function buildLineData(){
      return {
        labels:lastLabels,
        datasets:[
          {label:'Lane 1',data:lanes[1].counts,fill:false,tension:0.3,borderColor:lanes[1].color,pointRadius:4},
          {label:'Lane 2',data:lanes[2].counts,fill:false,tension:0.3,borderColor:lanes[2].color,pointRadius:4},
          {label:'Lane 3',data:lanes[3].counts,fill:false,tension:0.3,borderColor:lanes[3].color,pointRadius:4}
        ]
      }
    }

    const barChart = new Chart(barCtx,{
      type:'bar',
      data:buildBarData(),
      options:{plugins:{legend:{display:false}},responsive:true,maintainAspectRatio:false}
    });

    const lineChart = new Chart(lineCtx,{type:'line',data:buildLineData(),options:{responsive:true,maintainAspectRatio:false}}
    );

    // helpers
    function getLatest(l){return lanes[l].counts[lanes[l].counts.length-1]}
    function updateTooltips(){
      document.getElementById('t1').textContent = Math.round(average(lanes[1].counts));
      document.getElementById('t2').textContent = Math.round(average(lanes[2].counts));
      document.getElementById('t3').textContent = Math.round(average(lanes[3].counts));
    }
    function average(arr){return arr.reduce((a,b)=>a+b,0)/arr.length}

    updateTooltips();

    // interactions
    document.querySelectorAll('.btn').forEach(btn=>{
      btn.addEventListener('click',e=>{
        const action = btn.dataset.action;
        const lane = Number(btn.dataset.lane);
        if(action==='details') showDetails(lane);
        if(action==='highlight') highlightLane(lane);
      })
    });

    function showDetails(lane){
      alert(`Lane ${lane} — ${lanes[lane].label}\nLatest count: ${getLatest(lane)}\nAverage/hr: ${Math.round(average(lanes[lane].counts))}`);
    }

    let pinned = null;
    function highlightLane(lane){
      pinned = lane;
      // visually mark the lane-pill
      document.querySelectorAll('.lane-pill').forEach(el=>el.style.boxShadow='none');
      const pill = document.querySelector(`[data-lane='${lane}'] .lane-pill`);
      if(pill){pill.style.boxShadow = '0 10px 30px rgba(0,0,0,0.12)';}
      // update charts to focus
      lineChart.data.datasets.forEach(ds=>ds.hidden = (ds.label !== lanes[lane].label));
      barChart.data.datasets[0].data = [0,0,0];
      barChart.data.datasets[0].data[lane-1] = getLatest(lane);
      lineChart.update(); barChart.update();
    }

    // simulate traffic update
    function simulateOnce(){
      // random small mutation
      for(let k of [1,2,3]){
        const last = getLatest(k);
        // emergency spikes rarely
        const delta = (k===2) ? Math.round((Math.random()-0.95)*2) : Math.round((Math.random()-0.5)*6);
        let next = Math.max(0,last + delta);
        lanes[k].counts.push(next);
        if(lanes[k].counts.length>12) lanes[k].counts.shift();
      }
      // update charts
      barChart.data = buildBarData();
      lineChart.data = buildLineData();
      barChart.update(); lineChart.update();
      updateTooltips();
    }

    document.getElementById('simulate').addEventListener('click',()=>simulateOnce());

    // auto-refresh
    let autoId = setInterval(()=>{if(document.getElementById('autorefresh').checked) simulateOnce()},4000);

    // hover updater for lane cards to change marquee text and small subtext
    document.querySelectorAll('.lane-card').forEach(card=>{
      card.addEventListener('mouseenter',()=>{
        const lane = card.dataset.lane;
        const sub = document.getElementById(`l${lane}-sub`);
        const avg = Math.round(average(lanes[lane].counts));
        const marquee = document.getElementById('marqueeText');
        marquee.textContent = `Lane ${lane} — ${lanes[lane].label} • Avg/hr: ${avg} • Click Details or Highlight for more`;
      });
      card.addEventListener('mouseleave',()=>{
        document.getElementById('marqueeText').textContent = 'All systems normal • Lane-2 reserved for emergency vehicles • Use indicators • Drive safe';
      });
    });

    // keyboard shortcuts (1/2/3 to highlight lanes)
    window.addEventListener('keydown',(e)=>{
      if(['1','2','3'].includes(e.key)) highlightLane(Number(e.key));
      if(e.key==='r') { // reset pin
        pinned = null; lineChart.data.datasets.forEach(ds=>ds.hidden=false); barChart.data = buildBarData(); lineChart.update(); barChart.update(); document.querySelectorAll('.lane-pill').forEach(el=>el.style.boxShadow='none')
      }
    });

    // expose a small API for customization (developers)
    window.Dashboard = {
      setLaneName:(lane, name)=>{lanes[lane].label = name; document.querySelector(`[data-lane='${lane}'] .lane-title`).innerHTML = `Lane - ${lane} <small style=\"font-weight:400\">(${name})</small>`},
      setCounts:(lane,arr)=>{lanes[lane].counts = arr; lineChart.data = buildLineData(); barChart.data = buildBarData(); lineChart.update(); barChart.update(); updateTooltips();}
    }

  </script>
</body>
</html>
